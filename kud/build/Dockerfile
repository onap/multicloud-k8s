FROM ubuntu:18.04 as base
ARG KUD_ENABLE_TESTS=false
ARG KUD_PLUGIN_ENABLED=false
ARG CONTAINER_RUNTIME=docker
ARG KUD_DEBUG=""
ARG ENABLE_KATA_WEBHOOK=false
ARG KATA_WEBHOOK_RUNTIMECLASS=kata-clh
ENV KUD_ENABLE_TESTS=$KUD_ENABLE_TESTS
ENV KUD_PLUGIN_ENABLED=$KUD_PLUGIN_ENABLED
ENV CONTAINER_RUNTIME=$CONTAINER_RUNTIME
ENV KUD_DEBUG=$KUD_DEBUG
ENV ENABLE_KATA_WEBHOOK=$ENABLE_KATA_WEBHOOK
ENV KATA_WEBHOOK_RUNTIMECLASS=$KATA_WEBHOOK_RUNTIMECLASS
ADD . /usr/src/multicloud-k8s
USER root
SHELL ["/bin/bash", "-c"]
WORKDIR /usr/src/multicloud-k8s/kud/hosting_providers/containerized
RUN ./installer --install_pkg
ENTRYPOINT ["tail -f /dev/null"]
